<div data-turbolinks="false">
  <h1 class="text-center">現在地</h1>

  <div class="map-container">
    <!-- 地図を表示するdiv -->
    <div id="map" class="col-md-6"></div>
    <!-- 情報を表示するdiv -->
    <div id="info-container" class="col-md-6">
      <div id="info">
        <p>進んだ距離: <%= "#{@total_distance}" %>km</p>
        <p>残りの距離: <%= "#{@remaining_distance}" %> km</p>
        <p>次の札所まで: <%= "#{@next_temple_distance}" %> km</p>
        <p class="lead"><%= link_to 'ランニングを記録する', distance_logs_path, class: 'btn btn-lg btn-light fw-bold border-dark' %></p>
      </div>
    </div>
  </div>
</div>

<script>
let map

function initMap(){
  geocoder = new google.maps.Geocoder()

  map = new google.maps.Map(document.getElementById('map'), {
    center: {lat: 33.6027, lng: 133.4230},
    zoom: 8,
  });

  codeAddress('<%= @address %>');

  function codeAddress(address) {
    geocoder.geocode({'address': address}, function(results, status) {
      if (status === 'OK') {
        marker = new google.maps.Marker({
          map: map,
          position: results[0].geometry.location
        });
      } else {
        alert('該当する結果がありませんでした：' + status);
      }
    });
  }
}

</script>

<script src="https://maps.googleapis.com/maps/api/js?key=<%= ENV['MAPS_API_KEY'] %>&callback=initMap" async defer></script>
